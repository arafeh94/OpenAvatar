<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video</title>
    <style>
        .video-container {
            position: relative;
            width: 640px;
            height: 360px;
        }

        video {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
    </style>
    <script src="../services/avatar/avatar_client.js"></script>
</head>
<body>

<div id="video-container" class="video-container"></div>
<form id="textForm">
    <label for="text">Enter your text:</label><br>
    <textarea id="text" name="text" rows="10" cols="50" required>Artificial Intelligence (AI) is profoundly reshaping modern society, influencing a wide range of fields from healthcare and education to transportation, business, and entertainment. In healthcare, AI-powered algorithms enhance diagnostic accuracy, assist in the early detection of diseases like cancer, and accelerate drug development processes, while wearable devices track health metrics to provide real-time insights. In education, AI enables personalized learning experiences by adapting content to individual studentsâ€™ needs, fostering engagement and improving outcomes. Meanwhile, in transportation, AI drives the evolution of autonomous vehicles, optimizing traffic systems and reducing accidents. Businesses leverage AI for predictive analytics, supply chain optimization, and customer service enhancements, often using chatbots and recommendation systems to improve user experience. Entertainment platforms rely heavily on AI to curate personalized content, recommend media, and even create original music or artwork. Despite these advancements, AI also introduces significant challenges, such as ethical dilemmas surrounding privacy, algorithmic biases, and the potential displacement of jobs due to automation. As AI continues to integrate into daily life, its development must be guided by principles that ensure it benefits humanity as a whole, balancing innovation with fairness, accountability, and inclusivity.
    </textarea><br><br>
    <label for="voice_id">Voice ID:</label>
    <input type="number" id="voice_id" name="voice_id" value="7406" required><br><br>
    <label for="persona">Persona:</label>
    <select id="persona" name="persona" required>
        <option value="lisa_casual_720_pl">lisa_casual_720_pl</option>
    </select><br><br>
    <button type="submit">Submit</button>
</form>
<button onclick="avatarClient.stream(null, false)">Reset</button>

<div id="response" class="result" style="display: none;"></div>


<script>
    avatarClient = new AvatarClient('video-container', 'http://localhost:8080');
    avatarClient.mute(true);
    avatarClient.stream(null, false);
    document.getElementById('textForm').addEventListener('submit', async function (event) {
        event.preventDefault();

        const text = document.getElementById('text').value;
        const voice_id = document.getElementById('voice_id').value;
        const persona = document.getElementById('persona').value;
        const base_url = `${avatarClient.host}/request`;
        const params = `?text=${encodeURIComponent(text)}&persona=${persona}&voice_id=${voice_id}&as_token=true`;
        const url = base_url + params;
        try {
            avatarClient.mute(false);
            const response = await fetch(url);

            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
            }

            const result = await response.json();
            const token = result.token;
            const responseDiv = document.getElementById('response');
            responseDiv.style.display = 'block';
            responseDiv.textContent = `Response: ${token}`;
            avatarClient.measureLatency((latency) => {
                responseDiv.textContent += `, Time Taken: ${latency}s`;
            });
            avatarClient.stream(token, false);

        } catch (error) {
            console.error('Error:', error);
            const responseDiv = document.getElementById('response');
            responseDiv.style.display = 'block';
            responseDiv.textContent = `Error: ${error.message}`;
        }
    });
</script>

</body>
</html>
